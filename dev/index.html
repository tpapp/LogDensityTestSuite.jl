<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>LogDensityTestSuite · LogDensityTestSuite.jl</title><meta name="title" content="LogDensityTestSuite · LogDensityTestSuite.jl"/><meta property="og:title" content="LogDensityTestSuite · LogDensityTestSuite.jl"/><meta property="twitter:title" content="LogDensityTestSuite · LogDensityTestSuite.jl"/><meta name="description" content="Documentation for LogDensityTestSuite.jl."/><meta property="og:description" content="Documentation for LogDensityTestSuite.jl."/><meta property="twitter:description" content="Documentation for LogDensityTestSuite.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>LogDensityTestSuite.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>LogDensityTestSuite</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Constructing-distributions"><span>Constructing distributions</span></a></li><li><a class="tocitem" href="#transformations"><span>Transformations</span></a></li><li><a class="tocitem" href="#Mixtures"><span>Mixtures</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>LogDensityTestSuite</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>LogDensityTestSuite</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tpapp/LogDensityTestSuite.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="LogDensityTestSuite"><a class="docs-heading-anchor" href="#LogDensityTestSuite">LogDensityTestSuite</a><a id="LogDensityTestSuite-1"></a><a class="docs-heading-anchor-permalink" href="#LogDensityTestSuite" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.LogDensityTestSuite" href="#LogDensityTestSuite.LogDensityTestSuite"><code>LogDensityTestSuite.LogDensityTestSuite</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><strong>LogDensityTestSuite.jl</strong></p><p><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="lifecycle"/> <a href="https://github.com/tpapp/LogDensityTestSuite.jl/actions?query=workflow%3ACI"><img src="https://github.com/tpapp/LogDensityTestSuite.jl/workflows/CI/badge.svg" alt="build"/></a> <a href="http://codecov.io/github/tpapp/LogDensityTestSuite.jl?branch=master"><img src="http://codecov.io/github/tpapp/LogDensityTestSuite.jl/coverage.svg?branch=master" alt="codecov.io"/></a> <a href="https://zenodo.org/badge/latestdoi/199613252"><img src="https://zenodo.org/badge/199613252.svg" alt="DOI"/></a> <a href="https://tpapp.github.io/LogDensityTestSuite.jl/stable"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Documentation"/></a> <a href="https://tpapp.github.io/LogDensityTestSuite.jl/dev"><img src="https://img.shields.io/badge/docs-master-blue.svg" alt="Documentation"/></a></p><p>Construct distributions that support</p><ol><li><p>the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface (with gradients),</p></li><li><p>generating “samples” deterministically using low-discrepancy sequences.</p></li></ol><p>Gradient calculations use optimized closed formss instead automatic differentiation.</p><p>This package was developed mainly for testing <a href="https://github.com/tpapp/DynamicHMC.jl/">DynamicHMC.jl</a>, but other projects may also find it useful.</p><p><strong>Acknowledgements</strong></p><p>The development of this package was partially supported by the Austrian National Bank Jubileumsfonds Projekt 18847.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/LogDensityTestSuite.jl#L1">source</a></section></article><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This package is helpful in defining a family of distributions defined on <span>$\mathbb{R}^n$</span>, each with the following properties:</p><ol><li><p><em>samples</em> can be drawn from the distribution using quasi-random methods (low-discrepancy <a href="https://en.wikipedia.org/wiki/Sobol_sequence">Sobol sequences</a>),</p></li><li><p>the log density and its gradient can be calculated for each coordinate efficiently and accurately, without relying on automatic differentiation (using closed forms), implemented using the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface.</p></li></ol><p>This is achieved by constructing distributions using simple transformations that preserve these properties.</p><pre><code class="language-julia hljs">d = (funnel() ∘ shift([-1.0, 2.0]))(StandardMultivariateNormal(2))
samples(d, 10)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×10 Matrix{Float64}:
 -1.0       -0.32551   -1.67449   …  -1.88715   -0.511224  0.534121
  0.735759   0.957229   0.501209      0.228956   1.7316    0.794766</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.samples" href="#LogDensityTestSuite.samples"><code>LogDensityTestSuite.samples</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">samples(ℓ, N)
</code></pre><p>Draw <code>N</code> independent samples from <code>ℓ</code>, as columns of a matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/generic.jl#L49">source</a></section></article><h2 id="Constructing-distributions"><a class="docs-heading-anchor" href="#Constructing-distributions">Constructing distributions</a><a id="Constructing-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Constructing-distributions" title="Permalink"></a></h2><h3 id="Primitives"><a class="docs-heading-anchor" href="#Primitives">Primitives</a><a id="Primitives-1"></a><a class="docs-heading-anchor-permalink" href="#Primitives" title="Permalink"></a></h3><p>All distributions are constructed from <em>primitives</em>. For practical purposes, these are isotropic extensions of univariate distributions with known density (&amp; its derivative) and inverse quantile functions. Currently the package contains only one primitive, from the standard normal distribution, but similar distributions would be easy to define. However, it is preferred to construct more complex distributions using <a href="#transformations">transformations</a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.StandardMultivariateNormal" href="#LogDensityTestSuite.StandardMultivariateNormal"><code>LogDensityTestSuite.StandardMultivariateNormal</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Standard multivariate normal with the given dimension <code>K</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/primitives.jl#L5">source</a></section></article><p>We introduce the convention used for illustrating two-dimensional distributions below: lines increasing thickness are contour plots of the density, containing the 90%, ..., 10% highest posterior density regions:</p><pre><code class="language-julia hljs">const N2 = StandardMultivariateNormal(2)</code></pre><img src="index-d9b755c3.svg" alt="Example block output"/><h2 id="transformations"><a class="docs-heading-anchor" href="#transformations">Transformations</a><a id="transformations-1"></a><a class="docs-heading-anchor-permalink" href="#transformations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.linear" href="#LogDensityTestSuite.linear"><code>LogDensityTestSuite.linear</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear(A)
</code></pre><p>Transform a distribution on <code>x</code> to <code>y = Ax</code>, where <code>A</code> is a conformable square matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/transformations.jl#L125">source</a></section></article><pre><code class="language-julia hljs">A = [0.5 0.8;
     0.0 0.7]
D =  linear(A)(N2)</code></pre><img src="index-746500d8.svg" alt="Example block output"/><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.shift" href="#LogDensityTestSuite.shift"><code>LogDensityTestSuite.shift</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shift(b)
</code></pre><p>Transform a distribution on <code>x</code> to <code>y = x + b</code>, where <code>b</code> is a conformable vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/transformations.jl#L180">source</a></section></article><pre><code class="language-julia hljs">b = [1.0, 0.0]
D = (shift(b) ∘ linear(A))(N2)</code></pre><img src="index-44938109.svg" alt="Example block output"/><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.elongate" href="#LogDensityTestSuite.elongate"><code>LogDensityTestSuite.elongate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">elongate(k)
</code></pre><p>Transform a distribution on <code>x</code> to <span>$y = (1 + ‖x‖²)ᵏ⋅x$</span> where <span>$‖ ‖$</span> is the Euclidean norm and <code>k</code> is a real number. <code>k &gt; 0</code> values make the tails heavier.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/transformations.jl#L210">source</a></section></article><pre><code class="language-julia hljs">D = (shift(-2.2*b) ∘ elongate(1.2) ∘ shift(b) ∘ linear(I(2) ./ 4))(N2)</code></pre><img src="index-cbc6b91b.svg" alt="Example block output"/><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.funnel" href="#LogDensityTestSuite.funnel"><code>LogDensityTestSuite.funnel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">funnel()
</code></pre><p>Transform the distribution with the mapping <code>x ↦ y</code>, such that <code>y[begin] = x[begin]</code> and <code>y[i] = x[i] exp(x[begin])</code> for all other indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/transformations.jl#L276">source</a></section></article><pre><code class="language-julia hljs">D = funnel()(N2)</code></pre><img src="index-132dffaa.svg" alt="Example block output"/><h2 id="Mixtures"><a class="docs-heading-anchor" href="#Mixtures">Mixtures</a><a id="Mixtures-1"></a><a class="docs-heading-anchor-permalink" href="#Mixtures" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.mix" href="#LogDensityTestSuite.mix"><code>LogDensityTestSuite.mix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mix(α, ℓ1, ℓ2)
</code></pre><p>A <em>mixture</em> of two densities: <code>ℓ1(x)</code> with probability <code>α(x)</code>, and <code>ℓ2(x)</code> with probability <code>1-α(x)</code>. <code>α</code> needs to implement <a href="#LogDensityTestSuite.weight_and_gradient"><code>weight_and_gradient</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/mixtures.jl#L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.weight_and_gradient" href="#LogDensityTestSuite.weight_and_gradient"><code>LogDensityTestSuite.weight_and_gradient</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">weight_and_gradient(α, x)
</code></pre><p>Return <code>α(x)</code> and <code>∇α(x)</code>, where <code>α</code> is the mixture weight on the first distribution.</p><p>Public, but not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/mixtures.jl#L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LogDensityTestSuite.directional_weight" href="#LogDensityTestSuite.directional_weight"><code>LogDensityTestSuite.directional_weight</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">directional_weight(y)
</code></pre><p>Represents the weight <code>α(x) = logistic(dot(x, y))</code>. The Euclidean norm of <code>y</code> is related to the slope of the gradient of <code>α</code> in the given direction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/LogDensityTestSuite.jl/blob/1aa4292104ccd6cfbb3bdfe9c44ea6febf353e17/src/mixtures.jl#L90">source</a></section></article><p>Example with constant weight:</p><pre><code class="language-julia hljs">D = mix(0.5,
        (shift([-0.7, 0.3]) ∘ linear(I(2) ./ 1.5))(N2),
        (shift([0.7, 0.7]) ∘ linear(I(2) ./ 3))(N2))
contour_plot(D) # hide</code></pre><img src="index-3a2a2def.svg" alt="Example block output"/><pre><code class="language-julia hljs">D = mix(directional_weight([1,1]),
        (shift([-0.7, 0.3]) ∘ linear(I(2) ./ 1.5))(N2),
        (shift([0.7, 0.7]) ∘ linear(I(2) ./ 3))(N2))
contour_plot(D) # hide</code></pre><img src="index-ee155fcd.svg" alt="Example block output"/><p>New kinds of mixtures that depend on coordinates can be created by implementing the methods below.</p><pre><code class="language- hljs">LogDensityTestSuite.weight
LogDensityTestSuite.weight_and_gradient</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Tuesday 3 June 2025 12:02">Tuesday 3 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
